{% extends 'standard.html' %}{% load i18n static %}

{% block title %}{{ district.name }}{% endblock title %}

{% block breadcrumbs %}
<nav class="breadcrumbs">
  <a class="breadcrumbs__item" href="{% url 'landing' %}">Home</a> Â» <a class="breadcrumbs__item" href="{% url 'districts:list' %}">{% trans "School Districts" %}</a>
</nav>
{% endblock breadcrumbs %}

{% block content %}
<section class="row">
<div class="col-7">
<header class="page-header">
  <h1 class="page-headline">{{ district.name }}</h1>
  <p class="page-subtext">{{ district.city|title }}, {{ district.state }}</p>
  <p class="page-subtext">Accountability rating: {{ district.get_accountability_rating_display }}</p>
</header>

<div class="page-prose">
  {% lorem 1 p %}
</div>

<div class="card">
{% regroup district.campuses.all|dictsort:"school_type" by get_school_type_display as campus_list  %}
{% for campus in campus_list %}
  <h3 class="card-title">{{ campus.grouper }}s</h3>
  <ul class="card-list">
    {% for school in campus.list %}
    <li class="card-list-item"><a href="{{ school.get_absolute_url }}">{{ school.name }}</a></li>
    {% endfor %}
  </ul>
{% endfor %}
</div>
</div>

<div class="col-5">
  <div class="map map-district" id="district-map"></div>

  {% with nearby_districts=district.nearby_districts %}
  {% if nearby_districts %}
  <div class="card">
    <h3 class="card-title">{% trans "Nearby Districts" %}</h3>
    <ul class="card-list">
      {% for district in nearby_districts %}
        <li class="card-list-item"><a href="{{ district.get_absolute_url }}">{{ district.name }}</a></li>
      {% endfor %}
    </ul>
    {% if district.superintendent_of %}
    <h3 class="card-title">{{ district.superintendent_of.role }}</h3>
    {{ district.superintendent_of.name }}
    {% endif %}
  </div>
  {% endif %}
  {% endwith %}
</div>
</section>

{% comment %}
{% for stat in district.stats.all %}
  <section class="card">
    <h3>{{ stat.year.name }}</h3>
    <p>{% trans "No. of Students: " %}{{ stat.all_students_count }}</p>
  </section>
{% endfor %}
{% endcomment %}

<div class="ad-slot ad-slot-banner">
  <img src="https://placehold.it/728x90">
</div>

{% endblock content %}

{% block extra_script %}
<script>COORDS = {{ district.campus_geojson|safe }};</script>
<script>SHAPE = {"type": "Feature", "geometry": {{ district.shape.geojson|safe|default:'null' }}};</script>
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBrkB4T_tbnnFklJsJ_1jk8JwEpzhOYyKc"></script>
<script src="{% static 'scripts/district.js' %}"></script>
{% endblock extra_script %}
